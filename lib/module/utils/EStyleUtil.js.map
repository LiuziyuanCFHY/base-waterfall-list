{"version":3,"names":["NativeModules","EStyleSheet","rem","localLifeBizFeedCardAdaptScreen","changeLocalLifeBizFeedCardAdaptScreen","adaptScreen","DIMENSIONS_WHITE_LIST","EStyleWrapper","constructor","_defineProperty","$theme","KSAppearance","getColorScheme","styles","key","updateNumberStyles","create","includes","build","obj","globalRows","value","namespace","flatten","style","transNumberToRem","num","EStyleUtil"],"sources":["EStyleUtil.ts"],"sourcesContent":["import {\n    ImageStyle,\n    NativeModules,\n    StyleProp,\n    TextStyle,\n    ViewStyle,\n} from 'react-native';\nimport EStyleSheet from 'react-native-extended-stylesheet';\nimport { TTheme } from '@locallife/utils';\nimport { rem } from '@kid-ui/krn/lib/utils';\n\nexport let localLifeBizFeedCardAdaptScreen = false;\nexport const changeLocalLifeBizFeedCardAdaptScreen = (adaptScreen: boolean) => {\n    localLifeBizFeedCardAdaptScreen = adaptScreen;\n};\n\ntype Function<K> = () => K;\ntype Value<T> = T | (string & {});\ntype Variable<T> = Value<T> | Function<Value<T>>;\ntype Extended<T> = { [K in keyof T]: Variable<T[K]> };\n\nexport type AnyStyle = ImageStyle & TextStyle & ViewStyle;\ntype AnyStyleSet = { [key: string]: AnyStyle };\ntype MediaQuery = { [key: string]: Extended<AnyStyle> };\n\ntype EStyleSet<T = any> = {\n    [K in keyof T]: T[K] extends Variable<number>\n        ? T[K]\n        : T[K] extends MediaQuery\n        ? T[K]\n        : Extended<AnyStyle>;\n};\ntype StyleSet<T = any> = {\n    [K in keyof T]: T[K] extends number\n        ? T[K]\n        : T[K] extends string\n        ? T[K]\n        : T[K] extends Function<number>\n        ? number\n        : T[K] extends Function<string>\n        ? string\n        : T[K] extends MediaQuery\n        ? AnyStyleSet\n        : AnyStyle;\n};\n\nconst DIMENSIONS_WHITE_LIST = [\n    'flex',\n    'flexGrow',\n    'flexShrink',\n    'flexBasis',\n    'zIndex',\n    'aspectRatio',\n    'opacity',\n    'elevation',\n    'shadowOpacity',\n    'scale',\n];\n\ninterface EStyleRows {\n    $theme?: TTheme;\n}\nclass EStyleWrapper {\n    globalRows: EStyleRows = {\n        $theme: NativeModules.KSAppearance.getColorScheme() as TTheme,\n    };\n\n    updateNumberStyles(styles: AnyStyle): void {\n        for (const key in styles) {\n            if (\n                typeof styles[key] === 'number' &&\n                !DIMENSIONS_WHITE_LIST.includes(key)\n            ) {\n                styles[key] = rem(styles[key]);\n            }\n        }\n    }\n    create = <T = EStyleSet>(styles: EStyleSet<T>) => {\n        if (localLifeBizFeedCardAdaptScreen) {\n            for (const key in styles) {\n                if (typeof styles[key] === 'object') {\n                    this.updateNumberStyles(styles[key] as AnyStyle);\n                }\n            }\n        }\n        return EStyleSheet.create(styles) as StyleSet<T>;\n    };\n\n    build(obj: EStyleRows = {}) {\n        this.globalRows = { ...this.globalRows, ...obj };\n        EStyleSheet.build(this.globalRows);\n    }\n\n    value(namespace: keyof EStyleRows) {\n        return EStyleSheet.value(namespace);\n    }\n\n    flatten<T>(style?: StyleProp<T>) {\n        return EStyleSheet.flatten(style);\n    }\n\n    /**\n     * 将数字转换为rem，用于在EStyleUtil样式***外***使用\n     * 某些场景中你需要和EStyleUtil样式内的数字保持一致，可以使用该方法，因为EStyleUtil样式内的数字已经默认转换了\n     * @param num\n     */\n    transNumberToRem(num: number) {\n        return rem(num);\n    }\n}\nexport const EStyleUtil = new EStyleWrapper();\n"],"mappings":";;;AAAA,SAEIA,aAAa,QAIV,cAAc;AACrB,OAAOC,WAAW,MAAM,kCAAkC;AAE1D,SAASC,GAAG,QAAQ,uBAAuB;AAE3C,OAAO,IAAIC,+BAA+B,GAAG,KAAK;AAClD,OAAO,MAAMC,qCAAqC,GAAIC,WAAoB,IAAK;EAC3EF,+BAA+B,GAAGE,WAAW;AACjD,CAAC;AAgCD,MAAMC,qBAAqB,GAAG,CAC1B,MAAM,EACN,UAAU,EACV,YAAY,EACZ,WAAW,EACX,QAAQ,EACR,aAAa,EACb,SAAS,EACT,WAAW,EACX,eAAe,EACf,OAAO,CACV;AAKD,MAAMC,aAAa,CAAC;EAAAC,YAAA;IAAAC,eAAA,qBACS;MACrBC,MAAM,EAAEV,aAAa,CAACW,YAAY,CAACC,cAAc,CAAC;IACtD,CAAC;IAAAH,eAAA,iBAYwBI,MAAoB,IAAK;MAC9C,IAAIV,+BAA+B,EAAE;QACjC,KAAK,MAAMW,GAAG,IAAID,MAAM,EAAE;UACtB,IAAI,OAAOA,MAAM,CAACC,GAAG,CAAC,KAAK,QAAQ,EAAE;YACjC,IAAI,CAACC,kBAAkB,CAACF,MAAM,CAACC,GAAG,CAAa,CAAC;UACpD;QACJ;MACJ;MACA,OAAOb,WAAW,CAACe,MAAM,CAACH,MAAM,CAAC;IACrC,CAAC;EAAA;EAnBDE,kBAAkBA,CAACF,MAAgB,EAAQ;IACvC,KAAK,MAAMC,GAAG,IAAID,MAAM,EAAE;MACtB,IACI,OAAOA,MAAM,CAACC,GAAG,CAAC,KAAK,QAAQ,IAC/B,CAACR,qBAAqB,CAACW,QAAQ,CAACH,GAAG,CAAC,EACtC;QACED,MAAM,CAACC,GAAG,CAAC,GAAGZ,GAAG,CAACW,MAAM,CAACC,GAAG,CAAC,CAAC;MAClC;IACJ;EACJ;EAYAI,KAAKA,CAACC,GAAe,GAAG,CAAC,CAAC,EAAE;IACxB,IAAI,CAACC,UAAU,GAAG;MAAE,GAAG,IAAI,CAACA,UAAU;MAAE,GAAGD;IAAI,CAAC;IAChDlB,WAAW,CAACiB,KAAK,CAAC,IAAI,CAACE,UAAU,CAAC;EACtC;EAEAC,KAAKA,CAACC,SAA2B,EAAE;IAC/B,OAAOrB,WAAW,CAACoB,KAAK,CAACC,SAAS,CAAC;EACvC;EAEAC,OAAOA,CAAIC,KAAoB,EAAE;IAC7B,OAAOvB,WAAW,CAACsB,OAAO,CAACC,KAAK,CAAC;EACrC;;EAEA;AACJ;AACA;AACA;AACA;EACIC,gBAAgBA,CAACC,GAAW,EAAE;IAC1B,OAAOxB,GAAG,CAACwB,GAAG,CAAC;EACnB;AACJ;AACA,OAAO,MAAMC,UAAU,GAAG,IAAIpB,aAAa,CAAC,CAAC","ignoreList":[]}